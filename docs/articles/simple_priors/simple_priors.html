<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="bggjphd">
<title>The Smooth Step: Simple exchangeable hierarchical priors • bggjphd</title>
<script src="../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../../pkgdown.js"></script><meta property="og:title" content="The Smooth Step: Simple exchangeable hierarchical priors">
<meta property="og:description" content="bggjphd">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../../index.html">bggjphd</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../../articles/data/data.html">About the Data</a>
    <a class="dropdown-item" href="../../articles/max/max.html">The Max Step</a>
    <a class="dropdown-item" href="../../articles/simple_priors/simple_priors.html">The Smooth Step: Simple exchangeable hierarchical priors</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/bgautijonsson/bggjphd/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="simple_priors_files/kePrint-0.0.1/kePrint.js"></script><link href="simple_priors_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>The Smooth Step: Simple exchangeable hierarchical priors</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/bgautijonsson/bggjphd/blob/HEAD/vignettes/simple_priors/simple_priors.Rmd" class="external-link"><code>vignettes/simple_priors/simple_priors.Rmd</code></a></small>
      <div class="d-none name"><code>simple_priors.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="priors-and-setup">Priors and setup<a class="anchor" aria-label="anchor" href="#priors-and-setup"></a>
</h2>
<p>In this analysis the station-specific GEV parameters, <span class="math inline">\(\psi\)</span>, <span class="math inline">\(\tau\)</span>, <span class="math inline">\(\phi\)</span> and <span class="math inline">\(\gamma\)</span> are given exchangeable
hierarchical priors with no spatial information, i.e.</p>
<p><span class="math display">\[
\begin{aligned}
\psi_i &amp;\sim \mathrm{Normal}(\mu_\psi, \sigma_\psi^2) \\
\tau_i &amp;\sim \mathrm{Normal}(\mu_\tau, \sigma_\tau^2) \\
\phi_i &amp;\sim \mathrm{Normal}(\mu_\phi, \sigma_\phi^2) \\
\gamma_i &amp;\sim \mathrm{Normal}(\mu_\gamma, \sigma_\gamma^2)
\end{aligned}
\]</span></p>
<p>Where each <span class="math inline">\(\mu\)</span> parameter was
given a normal prior according to the table below where the means are
the means of the ML estimates and the standard deviations are calculated
by taking the variance of all ML estimates and multiplying it by
ten:</p>
<table class="table table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
psi
</td>
<td style="text-align:right;">
2.4647
</td>
<td style="text-align:right;">
0.2512
</td>
</tr>
<tr>
<td style="text-align:left;">
tau
</td>
<td style="text-align:right;">
-0.9633
</td>
<td style="text-align:right;">
0.3624
</td>
</tr>
<tr>
<td style="text-align:left;">
phi
</td>
<td style="text-align:right;">
0.0476
</td>
<td style="text-align:right;">
0.8362
</td>
</tr>
<tr>
<td style="text-align:left;">
gamma
</td>
<td style="text-align:right;">
0.3228
</td>
<td style="text-align:right;">
0.9899
</td>
</tr>
</tbody>
</table>
<p>Each <span class="math inline">\(\sigma\)</span> parameter was given
priors on the log precision scale according to a Normal(0, 2)
distribution. When converted to a standard deviation scale the prior
distribution can be seen in the figure below.</p>
<p><img src="simple_priors_files/figure-html/unnamed-chunk-3-1.png" width="100%"></p>
<p>The results were obtained by running <code><a href="../../reference/ms_smooth.html">ms_smooth()</a></code> in
parrallel on four cores with four chains each run for 4000 samples. Half
of those samples were designated as warm-up and so we have a total of
8000 samples from the posterior.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_iter</span> <span class="op">&lt;-</span> <span class="fl">4000</span></span>
<span><span class="fu">plan</span><span class="op">(</span><span class="va">multisession</span>, workers <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu">with_progress</span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/ms_smooth.html">ms_smooth</a></span><span class="op">(</span>n_samp <span class="op">=</span> <span class="va">n_iter</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu">plan</span><span class="op">(</span><span class="va">sequential</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="parameters">Parameters<a class="anchor" aria-label="anchor" href="#parameters"></a>
</h2>
<div class="section level3">
<h3 id="hyperpriors">Hyperpriors<a class="anchor" aria-label="anchor" href="#hyperpriors"></a>
</h3>
<div class="section level4">
<h4 id="log-precision-scale">Log precision scale<a class="anchor" aria-label="anchor" href="#log-precision-scale"></a>
</h4>
<table class="table table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
variable
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
median
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
mad
</th>
<th style="text-align:right;">
q5
</th>
<th style="text-align:right;">
q95
</th>
<th style="text-align:right;">
rhat
</th>
<th style="text-align:right;">
ess_bulk
</th>
<th style="text-align:right;">
ess_tail
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
theta[1]
</td>
<td style="text-align:right;">
8.611
</td>
<td style="text-align:right;">
8.533
</td>
<td style="text-align:right;">
0.527
</td>
<td style="text-align:right;">
0.494
</td>
<td style="text-align:right;">
7.909
</td>
<td style="text-align:right;">
9.603
</td>
<td style="text-align:right;">
1.035
</td>
<td style="text-align:right;">
167.706
</td>
<td style="text-align:right;">
286.834
</td>
</tr>
<tr>
<td style="text-align:left;">
theta[2]
</td>
<td style="text-align:right;">
6.632
</td>
<td style="text-align:right;">
6.601
</td>
<td style="text-align:right;">
0.385
</td>
<td style="text-align:right;">
0.352
</td>
<td style="text-align:right;">
6.105
</td>
<td style="text-align:right;">
7.260
</td>
<td style="text-align:right;">
1.008
</td>
<td style="text-align:right;">
393.800
</td>
<td style="text-align:right;">
376.732
</td>
</tr>
<tr>
<td style="text-align:left;">
theta[3]
</td>
<td style="text-align:right;">
4.200
</td>
<td style="text-align:right;">
4.191
</td>
<td style="text-align:right;">
0.155
</td>
<td style="text-align:right;">
0.153
</td>
<td style="text-align:right;">
3.965
</td>
<td style="text-align:right;">
4.470
</td>
<td style="text-align:right;">
1.007
</td>
<td style="text-align:right;">
925.157
</td>
<td style="text-align:right;">
1098.262
</td>
</tr>
<tr>
<td style="text-align:left;">
theta[4]
</td>
<td style="text-align:right;">
7.090
</td>
<td style="text-align:right;">
6.971
</td>
<td style="text-align:right;">
0.702
</td>
<td style="text-align:right;">
0.651
</td>
<td style="text-align:right;">
6.130
</td>
<td style="text-align:right;">
8.374
</td>
<td style="text-align:right;">
1.039
</td>
<td style="text-align:right;">
153.109
</td>
<td style="text-align:right;">
208.351
</td>
</tr>
</tbody>
</table>
<p><img src="simple_priors_files/figure-html/unnamed-chunk-7-1.png" width="100%"></p>
<p><img src="simple_priors_files/figure-html/unnamed-chunk-8-1.png" width="100%"></p>
</div>
<div class="section level4">
<h4 id="on-standard-deviation-scale">On standard deviation scale<a class="anchor" aria-label="anchor" href="#on-standard-deviation-scale"></a>
</h4>
<p><img src="simple_priors_files/figure-html/unnamed-chunk-9-1.png" width="100%"></p>
</div>
</div>
<div class="section level3">
<h3 id="gev-parameters">GEV Parameters<a class="anchor" aria-label="anchor" href="#gev-parameters"></a>
</h3>
<div class="section level4">
<h4 id="comparing-ml-and-mcmc-estimates">Comparing ML and MCMC estimates<a class="anchor" aria-label="anchor" href="#comparing-ml-and-mcmc-estimates"></a>
</h4>
<p><img src="simple_priors_files/figure-html/unnamed-chunk-11-1.png" width="100%"></p>
<p><img src="simple_priors_files/figure-html/unnamed-chunk-12-1.png" width="100%"></p>
</div>
<div class="section level4">
<h4 id="spatial-distributions">Spatial Distributions<a class="anchor" aria-label="anchor" href="#spatial-distributions"></a>
</h4>
<div class="section level5">
<h5 id="location">Location<a class="anchor" aria-label="anchor" href="#location"></a>
</h5>
<div class="section level6">
<h6 id="psi">psi<a class="anchor" aria-label="anchor" href="#psi"></a>
</h6>
<p><img src="simple_priors_files/figure-html/unnamed-chunk-14-1.png" width="100%"></p>
</div>
<div class="section level6">
<h6 id="mu">mu<a class="anchor" aria-label="anchor" href="#mu"></a>
</h6>
<p><img src="simple_priors_files/figure-html/unnamed-chunk-15-1.png" width="100%"></p>
</div>
</div>
<div class="section level5">
<h5 id="scale">Scale<a class="anchor" aria-label="anchor" href="#scale"></a>
</h5>
<div class="section level6">
<h6 id="tau">tau<a class="anchor" aria-label="anchor" href="#tau"></a>
</h6>
<p><img src="simple_priors_files/figure-html/unnamed-chunk-16-1.png" width="100%"></p>
</div>
<div class="section level6">
<h6 id="sigma">sigma<a class="anchor" aria-label="anchor" href="#sigma"></a>
</h6>
<p><img src="simple_priors_files/figure-html/unnamed-chunk-17-1.png" width="100%"></p>
</div>
</div>
<div class="section level5">
<h5 id="shape">Shape<a class="anchor" aria-label="anchor" href="#shape"></a>
</h5>
<div class="section level6">
<h6 id="phi">phi<a class="anchor" aria-label="anchor" href="#phi"></a>
</h6>
<p><img src="simple_priors_files/figure-html/unnamed-chunk-18-1.png" width="100%"></p>
</div>
<div class="section level6">
<h6 id="xi">xi<a class="anchor" aria-label="anchor" href="#xi"></a>
</h6>
<p><img src="simple_priors_files/figure-html/unnamed-chunk-19-1.png" width="100%"></p>
</div>
</div>
<div class="section level5">
<h5 id="trend">Trend<a class="anchor" aria-label="anchor" href="#trend"></a>
</h5>
<div class="section level6">
<h6 id="gamma">gamma<a class="anchor" aria-label="anchor" href="#gamma"></a>
</h6>
<p><img src="simple_priors_files/figure-html/unnamed-chunk-20-1.png" width="100%"></p>
</div>
<div class="section level6">
<h6 id="delta">Delta<a class="anchor" aria-label="anchor" href="#delta"></a>
</h6>
<p><img src="simple_priors_files/figure-html/unnamed-chunk-21-1.png" width="100%"></p>
</div>
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Brynjólfur Gauti Guðrúnar Jónsson.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
