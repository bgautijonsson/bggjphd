---
title: "basics"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{basics}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
#| eval: false
library(tidyverse)
library(progressr)
library(future)
library(bayesplot)
# devtools::load_all()
library(bggjphd)

n_iter <- 2000

plan(multisession, workers = 4)
with_progress({
  start <- Sys.time()
  results <- ms_smooth(n_samp = n_iter)
  stop <- Sys.time()
  
  stop - start
})
```

```{r}
results |> 
  filter(.iteration > n_iter/2) |> 
  subset_draws(
    c("mu_psi", "mu_phi", "mu_tau", "mu_gamma", "theta"), 
  ) |> 
  summarise_draws()
```

```{r}
results |> 
  filter(.iteration > n_iter/2) |> 
  subset_draws("theta") |> 
  mcmc_trace()
```

```{r}
results |> 
  filter(.iteration > n_iter/2) |> 
  subset_draws(c("theta", "mu_phi", "mu_psi", "mu_gamma", "mu_tau")) |> 
  as_draws_rvars() |> 
  map(
    posterior::rhat
  ) |> 
  reduce(c) |> 
  mcmc_rhat()
```

